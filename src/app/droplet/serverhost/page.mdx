import {CodeGroup} from "../../../components/mdx";
export const metadata = {
    title: 'Serverhost Droplet',
    description:
        "The serverhost droplet is responsible for configuring and starting up minecraft servers",
}


# Server Host Droplet

## Server versions
Server versions in the classic v2 sense don't exist anymore.
Servers are now just started using the server URL and a server configurator. Both server URL and server configurator are required,
if the needed [dynamic group properties](/server-group#dynamic-properties) are not set in the group configuration, a server of this
group will not start.

### Server URL
The server URL is nothing more than a simple download link to the wanted minecraft server jar.
In fact, it can be any link you want. The serverhost droplet will try to download and execute it using
user specified [options](#server-options). You can set the server URL through the `server-url` [dynamic group property](/server-group#dynamic-properties).

### Configurator
A server Configurator is a YML-file that provides information needed for a minecraft server to work with the cloud.
In most cases, it is responsible for setting the maximum players, port, online and forwarding mode of the server.
It is executed after the server template was copied to a new server. After it finishes executing, the server is started.
When defining a Configurator, you can use placeholders for any [controller](/server-group#controller-properties) or [dynamic](/server-group#dynamic-properties) property using this syntax: `%property-name%`.
Configurators are located in the `options/configurators` directory. If you want, you can create your own or modify existing ones.
To assign a configurator to a server, you need to set the [dynamic group property](/server-group#dynamic-properties) `configurator` to the configurator id.
The configurator id is equivalent to the configurator file name without the file extension (e.g. `velocity.yml` -> `velocity`)

### Configurator Examples

<CodeGroup>
    ```yml {{title: "velocity.yml"}}
    # A list of all configuration files
    paths:
          # The path to the configuration file
        - path: "velocity.toml"
          # The type of the configuration file (valid are TXT, PROPERTIES, TOML, YML, JSON)
          type: "TOML"
          # The data object
          data:
            bind: "%ip%:%port%"
            show-max-players: %max-players%
            forwarding-secret-file: "forwarding.secret"
            player-info-forwarding-mode: "MODERN"
          # The path to the configuration file
        - path: "forwarding.secret"
          # The type of the configuration file (valid are TXT, PROPERTIES, TOML, YML, JSON)
          type: "TXT"
          # The data object
          data: "%forwarding-secret%"
    ```
    ```yml {{ title: "spigot_standalone.yml" }}
    # A list of all configuration files
    paths:
          # The path to the configuration file
        - path: "server.properties"
          # The type of the configuration file (valid are TXT, PROPERTIES, TOML, YML, JSON)
          type: "PROPERTIES"
          # The data object
          data:
            server-ip: "%ip%"
            server-port: %port%
            max-players: %max-players%
            online-mode: true
    ```
    ```yml {{ title: "paper_velocity.yml" }}
    # A list of all configuration files
    paths:
          # The path to the configuration file
        - path: "server.properties"
          # The type of the configuration file (valid are TXT, PROPERTIES, TOML, YML, JSON)
          type: "PROPERTIES"
          # The data object
          data:
            server-ip: "%ip%"
            server-port: %port%
            max-players: %max-players%
            online-mode: false
          # The path to the configuration file
        - path: "config/paper-global.yml"
          # The type of the configuration file (valid are TXT, PROPERTIES, TOML, YML, JSON)
          type: "YML"
          # The data object
          data:
            proxies:
              velocity:
                enabled: "true"
                online-mode: "true"
                secret: "%forwarding-secret%"
    ```
</CodeGroup>


## Server options
For each server group, a YML-file is created in the `options` directory.
This file provides configuration for the java start command of this group. There are also options to change the directory where
started servers are stored in, and you can make the droplet instance ignore the server group.

```yml {{ title: "default.yml" }}
# start arguments
jvm:
    executable: C:\Program Files\Java\jdk-17.0.5\bin\java
    options: [-Xms%MIN_MEMORY%M, -Xmx%MAX_MEMORY%M, -Dcom.mojang.eula.agree=true,
        -jar]
    arguments: [nogui]
# whether the group is ignored by the serverhost droplet
ignore: false
# path to a custom running/temp directory for this group
parentDir: null
```

You can configure this file freely. The `jvm` configuration section is then parsed to a shell command and executed.

<CodeGroup>
    ```bash {{title: "Shell command syntax"}}
    [executable] [options] [server runtime file] [arguments]
    ```
    ```bash {{title: "default.yml shell command"}}
    C:\Program Files\Java\jdk-17.0.5\bin\java -Xms1024M -Xmx1024M -Dcom.mojang.eula.agree=true -jar server.jar nogui
    ```
</CodeGroup>

This also means that you can change the executable, arguments and options freely for each server group.
You can also use any [group property](/server-group#controller-properties). Property placeholders follow this syntax:
`%PROPERTY_NAME%`


## Tech-Stack
These are the technologies used by the Serverhost droplet:
- [Kotlin](https://kotlinlang.org/)
- [ProtoBuf](https://developers.google.com/protocol-buffers)
- [gRPC](https://grpc.io/)